<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width">
</head>

<body class="dark:bg-slate-900 dark:text-white">
    <div id="root"></div>
    <link rel="stylesheet" href="./style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const root = document.getElementById("root");

        const App = () => {
            const [converter, setConverter] = React.useState("time");

            const onChange = e => {
                setConverter(e.target.value);
            }

            return <div>
                <div className="py-4 border-b border-slate-900/10 px-0 bg-slate-600 lg:border-0 dark:bg-slate-800">
                    <div className="flex items-center justify-center gap-x-3">
                        <img className="" src="./img/converter.png" alt="" width="50px" />
                        <h1 className="text-4xl lg:text-5xl font-semibold text-white">Super Converter</h1>
                    </div>
                    <div className="absolute h-96 w-full inset-0 z-min bg-slate-600 dark:bg-slate-800"></div>
                </div>
                <section className="flex flex-col justify-center items-center max-w-screen-xl mx-auto my-14 lg:my-28 px-8 lg:px-16 py-4 lg:py-6">
                    <div className="w-full rounded-xl bg-stone-400 dark:bg-slate-600">
                        <div className="flex justify-items-center min-h-14">
                            <TabItem value="time" text="Time" selectedVal={converter} isFirst={true} setConverter={setConverter}></TabItem>
                            <TabItem value="distance" text="Distance" selectedVal={converter} isLast={true} setConverter={setConverter}></TabItem>
                        </div>
                        <div className="p-3 lg:p-12">
                            {converter === "time" ? <MinutesToHours /> : converter === "distance" ? <KillometersToMiles /> : "Select converter"}
                        </div>
                    </div>

                </section>
            </div>;
        };

        const KillometersToMiles = () => {
            return <h3>Killometers To Miles</h3>
        }

        const Input = ({ onChange, id }) => {
            return <div className="text_input">
                <span>
                    <input onChange={onChange}
                        id={id}
                        type="number" />
                </span>
            </div>;
        }

        const SelectInput = ({ items, _default, onChange }) => {
            const [focused, setFocused] = React.useState(false);
            const [isFirst, setFirst] = React.useState(true);

            const getSelectedIdx = val => {
                for (const i in items) {
                    if (items[i].val == val)
                        return i;
                }
            }
            const [selectedIdx, setSelectedIdx] = React.useState(getSelectedIdx(_default));

            // v 버튼
            let btn = <svg className="w-4 shrink-0 text-black" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 10" aria-hidden="true">
                <path fill="currentColor" fillRule="evenodd" d="M8 9.5L.5 2 1.55.95 8 7.4 14.45.95 15.5 2 8 9.5z" clipRule="evenodd"></path>
            </svg>;

            if (focused) {
                // x 버튼
                btn = <svg className="w-3 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 12" aria-hidden="true">
                    <path fill="currentColor" fillRule="evenodd" d="M12 1.05L10.95 0 6 4.95 1.05 0 0 1.05 4.95 6 0 10.95 1.05 12 6 7.05 10.95 12 12 10.95 7.05 6 12 1.05z" clipRule="evenodd"></path>
                </svg>;
            const onClick = e => {
                setSelectedIdx(getSelectedIdx(e.target.getAttribute('value')));
                onChange(selectedIdx);
            }

            return <div className="relative">
                <div className="select_input flex" onFocus={() => { setFocused(true); setFirst(false); }} onBlur={() => setFocused(false)}>
                    <span className="grow">
                        <input type="text" />
                    </span>
                    {btn}
                </div>
                {
                    !isFirst ? <div className="align-baseline">
                        <ul className={"absolute " + (focused ? "fade-in" : "fade-out")} >
                            {items.map((item) => {
                                return <li onClick={onClick} key={item.val} value={item.val}>{item.text}</li>
                            })}
                        </ul>
                    </div> : ''
                }
            </div >;
        }

        const TimeConverterLabel = ({ text, htmlFor }) => {
            return <label className="mx-0 mt-6 mb-1 sm:m-0" htmlFor={htmlFor}>{text}</label>
        }

        const MinutesToHours = () => {
            const [amount, setAmount] = React.useState(0);
            const [isOnHour, setOnHour] = React.useState(false);
            const firstSelected = React.useState('m');
            const secondSelected = React.useState('h');

            const onChange = e => {
                setAmount(e.target.value);
            }

            const items = [{ text: 'minutes', val: 'm' }, { text: 'hours', val: 'h' }];
            return <div>
                <div className="converter-input-box flex-col flex">
                    <TimeConverterLabel text="Amount" htmlFor="amount" />
                    <Input id="amount" onChange={onChange} />
                    <TimeConverterLabel text="From" htmlFor="from" />
                    <SelectInput id="from" items={items} _default={firstSelected[0]} />
                    <TimeConverterLabel text="To" htmlFor="to" />
                    <SelectInput id="to" items={items} _default={secondSelected[0]} />
                </div>
            </div>;
        };

        const TabItem = ({ value, text, selectedVal, isFirst = false, isLast = false, setConverter }) => {
            let className = "flex-1 flex justify-center items-center text-lg text-white";
            const selected = selectedVal === value;
            if (!selected) {
                className += " bg-stone-700 dark:bg-slate-900 text-gray-500";
            }
            if (isFirst) {
                className += " rounded-tl-xl"
            }
            if (isLast) {
                className += " rounded-tr-xl"
            }
            return <button onClick={() => {
                setConverter(value);
            }} className={className}>{text}</button>
        }
        const container = ReactDOM.createRoot(root);
        container.render(<App />);
    </script>
</body>

</html>